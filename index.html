<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Test de personnalité — « Boucle intérieure »</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#7c3aed;--muted:#94a3b8;--glass:rgba(255,255,255,0.03)}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{background:linear-gradient(180deg,#081226 0%, #071028 60%);color:#e6eef8;display:flex;align-items:center;justify-content:center;padding:24px}
    .wrap{width:100%;max-width:880px}
    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    header h1{font-size:20px;margin:0}
    .card{background:linear-gradient(180deg,var(--card),#071225);border-radius:14px;padding:20px;box-shadow:0 8px 30px rgba(2,6,23,0.6);backdrop-filter:blur(6px)}
    p.lead{color:var(--muted);margin-top:8px}
    form{margin-top:16px}
    .q{display:grid;grid-template-columns:1fr 120px;gap:12px;padding:12px;border-radius:10px;background:var(--glass);margin-bottom:10px;align-items:center}
    .q .text{font-size:14px}
    .answers{display:flex;gap:6px;justify-content:flex-end}
    label.btn{display:inline-flex;align-items:center;justify-content:center;min-width:36px;height:36px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04);cursor:pointer}
    input[type=radio]{display:none}
    input[type=radio]:checked + .btn{background:linear-gradient(90deg,var(--accent),#4c1d95);box-shadow:0 6px 18px rgba(124,58,237,0.25);border:none}
    footer.actions{display:flex;gap:8px;justify-content:flex-end;margin-top:14px}
    button.primary{background:linear-gradient(90deg,var(--accent),#4c1d95);border:none;color:white;padding:10px 14px;border-radius:10px;cursor:pointer}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px 12px;border-radius:10px;color:var(--muted);cursor:pointer}
    .result{margin-top:16px;padding:14px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01))}
    .score{font-size:28px;font-weight:700}
    .interpret{margin-top:8px;color:var(--muted)}
    .hint{font-size:13px;color:var(--muted);margin-top:6px}
    @media (max-width:640px){.q{grid-template-columns:1fr 1fr}.answers{justify-content:flex-start}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" aria-hidden>
          <rect width="24" height="24" rx="6" fill="#111827"></rect>
          <path d="M12 3v18M3 12h18" stroke="#7c3aed" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <div>
          <h1>Test de personnalité — « Boucle intérieure »</h1>
          <p class="lead">Mesure la tendance à <strong>refuser une part de soi</strong>, à tourner en boucle dans sa vie et à éprouver des difficultés à se transcender.</p>
        </div>
      </header>

      <div>
        <p class="hint">Instructions : Pour chaque affirmation, choisissez la réponse qui vous correspond le mieux (1 = Pas du tout, 5 = Tout à fait). Ce test est à visée introspective — il ne remplace pas un diagnostic professionnel.</p>

        <form id="testForm">
          <!-- 12 items -->

          <!-- We'll generate questions via JS, kept in markup for clarity -->
          <div id="questions"></div>

          <footer class="actions">
            <button type="button" class="ghost" id="resetBtn">Réinitialiser</button>
            <button type="button" class="primary" id="submitBtn">Voir le résultat</button>
          </footer>
        </form>

        <div id="resultBox" class="result" hidden aria-live="polite"></div>

      </div>
    </div>
  </div>

  <script>
    // Questions crafted to probe three sub-dimensions: 1) Refus de soi / parts rejetées
    // 2) Rigidité / répétition (boucle), 3) Difficulté de transcendance / stagnation
    const questions = [
      {id:1, text:"Je cache ou nie des aspects importants de moi-même par crainte du jugement."},
      {id:2, text:"Je me surprends à répéter les mêmes erreurs ou choix insatisfaisants."},
      {id:3, text:"Il m'est difficile d'accepter certaines émotions; je les repousse ou les minimise."},
      {id:4, text:"Ma vie semble parfois enfermée dans une 'boucle' dont je ne trouve pas la sortie."},
      {id:5, text:"Je ressens une lutte entre ce que je voudrais être et ce que je montre aux autres."},
      {id:6, text:"Même quand je décide de changer, je retombe souvent dans d'anciens schémas."},
      {id:7, text:"J'ai du mal à me transformer en profondeur, malgré mes efforts répétés."},
      {id:8, text:"Je me sens parfois en décalage avec moi-même, comme si une part de moi était absente."},
      {id:9, text:"Je rationalise mes comportements plutôt que d'en chercher la source émotionnelle."},
      {id:10, text:"Je m'accroche à des routines ou relations qui ne me conviennent plus par confort."},
      {id:11, text:"Je crains que changer profondément me fasse perdre qui je suis réellement."},
      {id:12, text:"J'ai besoin d'aide extérieure (ami, thérapeute) pour voir ce que je ne veux pas voir."}
    ];

    const qContainer = document.getElementById('questions');

    function makeQuestion(q){
      const div = document.createElement('div');
      div.className = 'q';
      div.innerHTML = `
        <div class="text"><strong>${q.id}.</strong> ${q.text}</div>
        <div class="answers" role="radiogroup" aria-labelledby="q${q.id}">
          ${[1,2,3,4,5].map(n=>`
            <label>
              <input type="radio" name="q${q.id}" value="${n}" />
              <span class="btn">${n}</span>
            </label>`).join('')}
        </div>
      `;
      return div;
    }

    questions.forEach(q=> qContainer.appendChild(makeQuestion(q)));

    // Utilities
    function getScore(){
      let score = 0; let answered = 0;
      for(const q of questions){
        const v = document.querySelector(`input[name=q${q.id}]:checked`);
        if(v){ score += parseInt(v.value,10); answered++; }
      }
      return {score, answered};
    }

    function interpret(score){
      // score range: 12..60
      if(score <= 20) return {
        level:'Faible — Peu de signes',
        desc:`Vous montrez peu des signes mesurés par ce test. Vous êtes probablement en contact avec la plupart de vos parts et vous parvenez à casser les routines qui ne vous servent plus.`
      };
      if(score <= 36) return {
        level:'Modéré — Boucle partielle',
        desc:`Il existe certaines zones où vous rejetez une part de vous-même ou répétez des schémas. Cela peut créer des périodes de stagnation; identifier ces moments précis peut aider à amorcer un changement.`
      };
      return {
        level:'Marqué — Boucle persistante',
        desc:`Vous présentez des traits nets de refus d'une part de vous, et de répétition de schémas empêchant une véritable transformation. Un travail d'exploration (psychothérapie, écriture, pratiques somatiques) peut être utile pour retrouver de la fluidité.`
      };
    }

    document.getElementById('submitBtn').addEventListener('click', ()=>{
      const {score, answered} = getScore();
      const box = document.getElementById('resultBox');
      if(answered < questions.length){
        box.hidden = false;
        box.innerHTML = `<strong>Complétez toutes les affirmations</strong><div class="interpret">Vous avez répondu ${answered} / ${questions.length} items.</div>`;
        return;
      }
      const it = interpret(score);
      box.hidden = false;
      box.innerHTML = `
        <div class="score">Score : ${score} / ${questions.length*5}</div>
        <div class="interpret"><strong>${it.level}</strong><div style="margin-top:8px">${it.desc}</div></div>
        <div style="margin-top:12px;color:var(--muted)"><strong>Conseils pratiques :</strong>
          <ul>
            <li>Tenir un journal des moments où la "boucle" apparaît (déclencheur, pensées, émotions).</li>
            <li>Tester une petite expérimentation ciblée (changer une routine <em>pendant</em> une semaine).</li>
            <li>Explorer le dialogue intérieur : quelles parts de vous sont niées ? Qui a peur du changement ?</li>
            <li>Si la situation vous pèse, envisager l'aide d'un professionnel (psychologue, thérapeute) pour un travail en profondeur.</li>
          </ul>
        </div>
        <div style="margin-top:10px;display:flex;gap:8px;justify-content:flex-end">
          <button class="ghost" id="copyBtn">Copier le résultat</button>
          <button class="primary" id="shareBtn">Télécharger (HTML)</button>
        </div>
      `;

      // attach small interactions
      document.getElementById('copyBtn').addEventListener('click', ()=>{
        const summary = `Test "Boucle intérieure" — score ${score}/${questions.length*5} — ${it.level} : ${it.desc}`;
        navigator.clipboard?.writeText(summary).then(()=>{
          alert('Résumé copié dans le presse-papiers.');
        }).catch(()=>alert('Impossible de copier — veuillez copier manuellement.'));
      });

      document.getElementById('shareBtn').addEventListener('click', ()=>{
        // create a simplified result HTML and prompt download
        const resultHtml = `<!doctype html><meta charset="utf-8"><title>Résultat — Boucle intérieure</title><style>body{font-family:Inter,system-ui;max-width:700px;margin:30px;padding:20px;background:#f7f9fc;color:#071229}</style><h1>Résultat du test — Boucle intérieure</h1><p>Score: ${score} / ${questions.length*5}</p><p>${it.level}</p><p>${it.desc}</p><p>Généré le ${new Date().toLocaleString()}</p>`;
        const blob = new Blob([resultHtml], {type:'text/html;charset=utf-8'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = 'resultat-boucle-interieure.html'; document.body.appendChild(a); a.click(); a.remove();
        URL.revokeObjectURL(url);
      });

    });

    document.getElementById('resetBtn').addEventListener('click', ()=>{
      document.getElementById('testForm').reset();
      const box = document.getElementById('resultBox'); box.hidden = true; box.innerHTML = '';
    });

    // small accessibility: focus first radio of first question when tabbing inside
    const firstRadios = document.querySelectorAll('input[type=radio]');
    if(firstRadios.length) firstRadios[0].tabIndex = 0;

  </script>
</body>
</html>
